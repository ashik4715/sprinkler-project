<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css
    "
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js
    "></script>
    <script
      src="https://code.jquery.com/jquery-3.6.3.min.js"
      integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
      crossorigin="anonymous"
    ></script>

    <!-- Load chart js into the DOM -->
    <script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1.1/dist/chart.xkcd.min.js"></script>

    <link rel="stylesheet" href="style.css" />
    <title>Sprinkler Project</title>
  </head>
  <body>
    <div class="container">
      <h2 class="text-center text-light py-3">Sprinkler/Detector Activation</h2>

      <div class="row text-light">
        <div class="col">
          <form action="" class="form-detection">
            <h4 class="text-info pb-2">Detection / Sprinkler Response Time</h4>
            <p class="text-light fst-italic py-3">
              Put desired value in the box or chose the pre-determined value by
              ticking one of the suggested options
            </p>

            <!-- RTI Row -->
            <div class="row pb-3">
              <div class="col-sm">
                RTI <br />
                Response Time Index
              </div>
              <div class="col-sm">
                <input
                  class="text-center"
                  type="number"
                  step="0.1"
                  name="RTI"
                  id="slider_input1"
                  placeholder="Slide Or Input RTI"
                  onwheel="return false;"
                  required
                />
                <p class="text-center">&radic;m&lowast;s</p>
              </div>
              <div class="col-sm">
                <div class="range-container">
                  <input type="range" id="range" min="0" max="1000" />
                  <label for="range">500</label>
                </div>
              </div>
            </div>

            <!-- Height Row -->
            <div class="row py-2">
              <div class="col-sm">Height</div>
              <div class="col-sm">
                <input
                  class="text-center"
                  type="number"
                  step="0.1"
                  name="H"
                  id="slider_input2"
                  placeholder="Slide Or Input Height"
                  onwheel="return false;"
                  required
                />
              </div>
              <div class="col-sm">
                <div class="range-container">
                  <input type="range" id="range2" min="0" max="100" />
                  <label for="range2">50</label>
                </div>
              </div>
            </div>

            <!-- Radial Distance Row -->
            <div class="row py-3">
              <div class="col-sm">Radial Distance</div>
              <div class="col-sm">
                <input
                  class="text-center"
                  type="number"
                  step="0.1"
                  name="R"
                  id="slider_input3"
                  placeholder="Slide Radial Distance"
                  onwheel="return false;"
                  required
                />
              </div>
              <div class="col-sm">
                <div class="range-container">
                  <input type="range" id="range3" min="0" max="100" />
                  <label for="range3">50</label>
                </div>
              </div>
            </div>

            <!-- Aplha Row -->
            <div class="row py-2">
              <div class="col-sm">
                &alpha; <br />
                Based on T sqaure Fire <br />
                Q = &alpha;t&sup2;
              </div>
              <div class="col-sm">
                <input
                  class="text-center"
                  type="number"
                  step="0.001"
                  name="alpha"
                  id="alpha"
                  placeholder="&alpha; required"
                  onwheel="return false;"
                  required
                />
                <p class="text-center">kW/s&sup2;</p>
                <ul
                  style="list-style-type: none"
                  class="list-group list-group-horizontal-md"
                >
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="flexRadioDefault"
                        id="flexRadioDefault1"
                        value="0.003"
                      />
                      <label class="form-check-label" for="flexRadioDefault1">
                        Slow
                      </label>
                    </div>
                  </li>
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="flexRadioDefault"
                        id="flexRadioDefault2"
                        value="0.012"
                      />
                      <label class="form-check-label" for="flexRadioDefault2">
                        Medium
                      </label>
                    </div>
                  </li>
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="flexRadioDefault"
                        id="flexRadioDefault3"
                        value="0.047"
                      />
                      <label class="form-check-label" for="flexRadioDefault3">
                        Fast
                      </label>
                    </div>
                  </li>
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="flexRadioDefault"
                        id="flexRadioDefault4"
                        value="0.188"
                      />
                      <label class="form-check-label" for="flexRadioDefault4">
                        Ultrafast
                      </label>
                    </div>
                  </li>
                </ul>
              </div>
            </div>

            <!-- Activation Temperature row -->
            <div class="row py-2">
              <div class="col-sm">Activation Temperature</div>
              <div class="col-sm">
                <input
                  class="text-center"
                  type="number"
                  name="tAmbient"
                  id="tAmbient"
                  step="0.1"
                  placeholder="Temperature required"
                  onwheel="return false;"
                  required
                />
                <p class="text-center">&#8451;</p>
                <ul
                  style="list-style-type: none"
                  class="list-group list-group-horizontal-md"
                >
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="tAmbientRadio"
                        id="flexRadioDefault5"
                        value="68"
                      />
                      <label class="form-check-label" for="flexRadioDefault5">
                        68&#8451;
                      </label>
                    </div>
                  </li>
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="tAmbientRadio"
                        id="flexRadioDefault6"
                        value="79"
                      />
                      <label class="form-check-label" for="flexRadioDefault7">
                        79&#8451;
                      </label>
                    </div>
                  </li>
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="tAmbientRadio"
                        id="flexRadioDefault8"
                        value="93"
                      />
                      <label class="form-check-label" for="flexRadioDefault9">
                        93&#8451;
                      </label>
                    </div>
                  </li>
                  <li class="px-2">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="tAmbientRadio"
                        id="flexRadioDefault10"
                        value="141"
                      />
                      <label class="form-check-label" for="flexRadioDefault10">
                        141&#8451;
                      </label>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
            <!-- Ambience Temperature row -->
            <div class="row py-2">
              <div class="col-sm">Ambience Temperature</div>
              <div class="col-sm">
                <input
                  class="text-center"
                  type="number"
                  name="tAct"
                  id="tAct"
                  step="0.1"
                  placeholder="Ambience required"
                  onwheel="return false;"
                  required
                />
                <p class="text-center">&#8451;</p>
              </div>
              <div class="col-sm">
                <ul style="list-style-type: none">
                  <li>
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="tActRadio"
                        id="flexRadioDefault11"
                        value="20"
                      />
                      <label class="form-check-label" for="flexRadioDefault11">
                        20&#8451;
                      </label>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
            <!-- end Ambience Temperature row -->

            <div class="row py-2">
              <div class="col-sm-6">
                <p>Activation time</p>
                <p>Fire Size</p>
              </div>
              <div class="col-sm-6">
                <p class="activationTime-result result-style">activation</p>
                <p class="fireSize-result result-style">fireSize</p>
                <p class="vGas-result result-style">vGas</p>
                <p class="tGas-result result-style">tGas</p>
              </div>
            </div>

            <div class="row py-2 pt-4">
              <div class="col">
                <button class="btn btn-calculate" type="submit">
                  Calculate
                </button>
              </div>
              <div class="col">
                <button class="btn btn-clear" type="button">Clear Data</button>
              </div>
              <div class="col">
                <button class="btn btn-print" type="button">
                  Print Results
                </button>
              </div>
            </div>
          </form>
        </div>

        <!-- Results -->
        <div class="col">
          <img class="img-fluid" src="img/equations.png" alt="equations" />
          <p class="text-light fst-italic py-3">
            The correlations for jet temperatures and velocities were developed
            from data by Alpert
          </p>
          <canvas class="pb-5"></canvas>
        </div>
      </div>
    </div>

    <div class="activation-plot py-5">
      <div class="container-lg">
        <!-- <svg class="line-chart" style="max-height: 675px"></svg> -->
      </div>
    </div>
  </body>

  <!-- inputs and radio button Javascript Below -->
  <script>
    const range = document.getElementById("range");
    const range2 = document.getElementById("range2");
    const range3 = document.getElementById("range3");

    range.addEventListener("input", (e) => {
      const value = +e.target.value;
      const label = e.target.nextElementSibling;

      const range_width = getComputedStyle(e.target).getPropertyValue("width");
      const label_width = getComputedStyle(label).getPropertyValue("width");

      const num_width = +range_width.substring(0, range_width.length - 2);
      const num_label_width = +label_width.substring(0, label_width.length - 2);

      const max = +e.target.max;
      const min = +e.target.min;

      const left =
        value * (num_width / max) -
        num_label_width / 2 +
        scale(value, min, max, 10, -10);
      label.style.left = `${left}px`;

      label.innerHTML = value;
      document.getElementById("slider_input1").value = value;
    });
    range2.addEventListener("input", (e) => {
      const value = +e.target.value;
      const label = e.target.nextElementSibling;

      const range_width = getComputedStyle(e.target).getPropertyValue("width");
      const label_width = getComputedStyle(label).getPropertyValue("width");

      const num_width = +range_width.substring(0, range_width.length - 2);
      const num_label_width = +label_width.substring(0, label_width.length - 2);

      const max = +e.target.max;
      const min = +e.target.min;

      const left =
        value * (num_width / max) -
        num_label_width / 2 +
        scale(value, min, max, 10, -10);
      label.style.left = `${left}px`;

      label.innerHTML = value;
      document.getElementById("slider_input2").value = value;
    });
    range3.addEventListener("input", (e) => {
      const value = +e.target.value;
      const label = e.target.nextElementSibling;

      const range_width = getComputedStyle(e.target).getPropertyValue("width");
      const label_width = getComputedStyle(label).getPropertyValue("width");

      const num_width = +range_width.substring(0, range_width.length - 2);
      const num_label_width = +label_width.substring(0, label_width.length - 2);

      const max = +e.target.max;
      const min = +e.target.min;

      const left =
        value * (num_width / max) -
        num_label_width / 2 +
        scale(value, min, max, 10, -10);
      label.style.left = `${left}px`;

      label.innerHTML = value;
      document.getElementById("slider_input3").value = value;
    });

    const scale = (num, in_min, in_max, out_min, out_max) => {
      return (
        ((num - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min
      );
    };

    $(document).ready(function () {
      $("input[type='radio']").click(function (e) {
        var radioValue = $("input[name='flexRadioDefault']:checked").val();
        var radioAmbient = $("input[name='tAmbientRadio']:checked").val();
        var radioAct = $("input[name='tActRadio']:checked").val();
        e.preventDefault();

        if (radioValue) {
          document.getElementById("alpha").value = radioValue;
        }
        if (radioAmbient) {
          document.getElementById("tAmbient").value = radioAmbient;
        }
        if (radioAct) {
          //const numActParsed = parseFloat(radioAct);
          document.getElementById("tAct").value = radioAct;
        }
      });
    });
  </script>

  <!-- Excel Generate Javascript Below -->
  <script>
    $(document).ready(function () {
      var RTI = $("input[name='RTI']").val();
      var R = $("input[name='R']").val();
      var H = $("input[name='H']").val();
      var radioAmbient = $("input[name='tAmbient']").val();
      var radioAct = $("input[name='tAct']").val();
      const numAmbientParsed = parseFloat(radioAmbient);
      const numActParsed = parseFloat(radioAct);
      var tAmbientVal = numAmbientParsed + 273;
      var tActVal = numActParsed + 273;
      var alphaVal = $("input[name='alpha']").val();
      var vGas, tGas, activationTime, fireSize, Q, tau, deltaT;

      $(".btn-clear").click(function () {
        $("form")[0].reset();
      });
      $("form").submit(function (event) {
        event.preventDefault(); // prevent default form submission

        var num1 = 0;
        var num2 = $("input[name='RTI']").val();
        var H = $("input[name='H']").val();
        var R = $("input[name='R']").val();
        var num5 = $("input[name='alpha']").val();
        var radioAmbient = $("input[name='tAmbient']").val();
        var radioAct = $("input[name='tAct']").val();
        const numAmbientParsed = parseFloat(radioAmbient);
        const numActParsed = parseFloat(radioAct);
        var num6 = numAmbientParsed + 273;
        var num7 = numActParsed + 273;
        // define the arrays to store the values
        var arr1 = [];
        var arr2 = [];
        var arr3 = [];
        var arr4 = [];
        var arr5 = [];
        var arr6 = [];
        var arr7 = [];
        var arr8 = [];
        var arr9 = [];
        var arr10 = [];
        var arr11 = [];
        var arr12 = [];

        // increment the numbers and store in the arrays until counter hits 100
        // vGas-result, tGas-result, activationTime-result, fireSize-result
        for (var i = 0; i < 100; i++) {
          Q = num5 * Math.pow(i, 2);
          if (R / H > 0.15) {
            vGas = 0.2 * (Math.pow(Q, 1 / 3) * Math.pow(H, 1 / 2));
          }
          if (R / H <= 0.15) {
            vGas = 0.95 * Math.pow(Q / H, 1 / 3);
          }
          if (R / H > 0.18) {
            tGas = num6 + (5.38 / H) * Math.pow(Q / R, 2 / 3);
          }
          if (R / H <= 0.18) {
            tGas = num6 + (16.9 * Math.pow(Q, 2 / 3)) / Math.pow(H, 5 / 3);
          }
          tau = num2 / Math.sqrt(vGas);
          deltaT = (1 / tau) * tGas;
          num1++;
          num2++;
          H++;
          R++;
          num5++;
          num6++;
          num7++;
          arr1.push(num1);
          arr2.push(Q);
          arr3.push(vGas);
          arr4.push(tGas);
          arr5.push(num2);
          arr6.push(H);
          arr7.push(R);
          arr8.push(num5);
          arr9.push(num6);
          arr10.push(num7);
          arr11.push(tau);
          arr12.push(deltaT);
        }
        console.log(num1, Q, vGas, tGas, num2, H, R, num5, num6, tau, deltaT);
        // export the arrays to CSV
        var csv = "time,Q,RTI,H,R,alpha,tAmbient,tActivation\n";
        for (var i = 0; i < arr1.length; i++) {
          csv +=
            arr1[i] +
            "," +
            arr2[i] +
            "," +
            arr3[i] +
            "," +
            arr4[i] +
            "," +
            arr4[i] +
            "," +
            arr5[i] +
            "," +
            arr6[i] +
            "," +
            arr7[i] +
            "," +
            arr8[i] +
            "\n";
        }
        var link = document.createElement("a");
        link.setAttribute(
          "href",
          "data:text/csv;charset=utf-8," + encodeURIComponent(csv)
        );
        link.setAttribute("download", "data.csv");
        link.click();
      });
    });
  </script>
  <!-- Excel Generate Javascript Below -->
</html>
